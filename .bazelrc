common --symlink_prefix=bazel-
common --experimental_convenience_symlinks=normal

build --config=clang --experimental_cpp_modules
build --config=debug

build:clang --repo_env=BAZEL_COMPILER=clang
build:clang --repo_env=CC=/usr/bin/clang
build:clang --repo_env=CXX=/usr/bin/clang++
build:clang --cxxopt=-std=c++23 --cxxopt=-fmodules-embed-all-files
build:clang --cxxopt=-stdlib=libc++ --linkopt=-stdlib=libc++

common:debug --compilation_mode=dbg
common:debug --experimental_output_paths=strip

test --test_output=errors
test --test_summary=terse
build --output_filter='^(?!@googletest//.*)$' # Supress warning from compilation of GoogleTest sources.

# NOTE: These are 'common' flags to be used with cquery.

# No effect.
common:coverage --features=coverage_enabled
common:coverage --combined_report=lcov # `lcov` is the only and the defeault value supported at this time.
# common:coverage --test_env=LLVM_PROFILE_FILE=%t.profraw

# Important: 0-sized coverage files, no-data without this flag.
common:coverage --instrument_test_targets

# Important: Coverage files with empty entries are produced otherwise.
common:coverage --experimental_generate_llvm_lcov
common:coverage --cxxopt=-fprofile-instr-generate --cxxopt=-fcoverage-mapping
common:coverage --linkopt=-fprofile-instr-generate

# Do not help.
# common:coverage --cxxopt=-fprofile-arcs --cxxopt=-ftest-coverage # C++20 modules.
# common:coverage--instrumentation_filter='^//main[/:].*$'

coverage:inpsect --test_output=all
coverage:inpsect --test_summary=detailed
coverage:inspect --subcommands

build --sandbox_debug --verbose_failures --subcommands
build --show_result 2 # Print output file names.
